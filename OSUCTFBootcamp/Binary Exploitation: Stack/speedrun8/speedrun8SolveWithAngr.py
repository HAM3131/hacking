import angr
import sys
from pwn import *

path_to_binary = "./challenge/chall_8"
project = angr.Project(path_to_binary)
initial_state = project.factory.entry_state()
simulation = project.factory.simgr(initial_state)

good_address = 0x400924 
simulation.explore(find=good_address)
solution = b''

if simulation.found:
    solution_state = simulation.found[0]
    solution = solution_state.posix.dumps(sys.stdin.fileno())
    print(solution)
else:
    raise Exception('Could not find the solution')

##########################################################
EXE = ELF("./challenge/chall_8")
context.binary = EXE
context.log_level = "DEBUG"

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13379)
	return r

io = conn(False)

io.sendline(solution)
io.interactive()

io.close()